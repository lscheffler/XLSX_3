*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="faststrings.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS faststrings AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="edtResult" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFileName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="clsFastStrings" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleRawFile" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtBegDelimiter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtEndDelimiter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lstReport" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command5" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: lostring
		*p: _memberdata		&& XML Metadata for customizable properties
	*</DefinedPropArrayMethod>

	AllowOutput = .F.
	AutoCenter = .T.
	Caption = "FastStrings Testing"
	DoCreate = .T.
	Height = 560
	lostring = .NULL.
	Name = "FASTSTRINGS"
	Width = 1165
	_memberdata = <VFPData>
		<memberdata name="lostring" type="property" display="loString"/>
		</VFPData>		&& XML Metadata for customizable properties

	ADD OBJECT 'clsFastStrings' AS faststrings WITH ;
		Height = 17, ;
		Left = 1074, ;
		Name = "clsFastStrings", ;
		Top = 4, ;
		Width = 81
		*< END OBJECT: ClassLib="faststrings.vcx" BaseClass="label" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "Open File", ;
		Height = 25, ;
		Left = 5, ;
		Name = "Command1", ;
		Top = 5, ;
		Width = 119
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command2' AS commandbutton WITH ;
		Caption = "Get XML Segment", ;
		Height = 24, ;
		Left = 494, ;
		Name = "Command2", ;
		Top = 264, ;
		Width = 113
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command3' AS commandbutton WITH ;
		Caption = "Get First XML Segment", ;
		Height = 24, ;
		Left = 618, ;
		Name = "Command3", ;
		Top = 264, ;
		Width = 146
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command4' AS commandbutton WITH ;
		Caption = "Get Next XML Segment", ;
		Enabled = .F., ;
		Height = 24, ;
		Left = 772, ;
		Name = "Command4", ;
		Top = 264, ;
		Width = 146
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command5' AS commandbutton WITH ;
		Caption = "Get All XML Segments", ;
		Height = 24, ;
		Left = 925, ;
		Name = "Command5", ;
		Top = 264, ;
		Width = 146
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'edtResult' AS editbox WITH ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 0,0,0, ;
		Height = 255, ;
		Left = 5, ;
		Name = "edtResult", ;
		ReadOnly = .T., ;
		Top = 299, ;
		Width = 975
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		Caption = "Begin Delimiter or XML Segment", ;
		Height = 32, ;
		Left = 5, ;
		Name = "Label1", ;
		Top = 260, ;
		Width = 106, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		Caption = "End Delimiter", ;
		Height = 17, ;
		Left = 267, ;
		Name = "Label2", ;
		Top = 269, ;
		Width = 77, ;
		WordWrap = .F.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblFileName' AS label WITH ;
		Caption = "<filename>", ;
		Height = 22, ;
		Left = 138, ;
		Name = "lblFileName", ;
		Top = 8, ;
		Width = 1001
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lstReport' AS listbox WITH ;
		Height = 254, ;
		Left = 994, ;
		Name = "lstReport", ;
		Top = 299, ;
		Width = 165
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'oleRawFile' AS olecontrol WITH ;
		Height = 220, ;
		Left = 5, ;
		Name = "oleRawFile", ;
		Top = 36, ;
		Width = 1154
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\ieframe.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAhOYIYYdYBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAAEV3AAC9FgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'txtBegDelimiter' AS textbox WITH ;
		Height = 24, ;
		Left = 114, ;
		Name = "txtBegDelimiter", ;
		Top = 264, ;
		Width = 135
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtEndDelimiter' AS textbox WITH ;
		Height = 24, ;
		Left = 349, ;
		Name = "txtEndDelimiter", ;
		Top = 264, ;
		Width = 135
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Destroy
		IF !ISNULL(thisform.loString)
			thisform.clsFastStrings.ReleaseStringFromHeap(thisform.loString)
		ENDIF
	ENDPROC

	PROCEDURE Init
		thisform.Resize()
	ENDPROC

	PROCEDURE Resize
		LOCAL lnHeight
		lnHeight = INT((thisform.Height - 95) / 2)
		thisform.oleRawFile.Width  = thisform.Width - 10
		thisform.oleRawFile.Height = lnHeight
		
		thisform.edtResult.Top    = thisform.oleRawFile.Height + 85
		thisform.edtResult.Width  = thisform.Width - 185
		thisform.edtResult.Height = lnHeight
		
		thisform.lstReport.Top    = thisform.edtResult.Top
		thisform.lstReport.Height = thisform.edtResult.Height
		thisform.lstReport.Left   = thisform.edtResult.Left + thisform.edtResult.Width + 15
		
		thisform.Label1.Top = thisform.oleRawFile.Top + thisform.oleRawFile.Height + 4
		thisform.Label2.Top = thisform.Label1.Top + 9
		
		thisform.txtBegDelimiter.Top = thisform.Label1.Top + 4
		thisform.txtEndDelimiter.Top = thisform.txtBegDelimiter.Top
		
		thisform.command2.Top = thisform.txtBegDelimiter.Top
		thisform.command3.Top = thisform.txtBegDelimiter.Top
		thisform.command4.Top = thisform.txtBegDelimiter.Top
		thisform.command5.Top = thisform.txtBegDelimiter.Top
	ENDPROC

	PROCEDURE Command1.Click
		LOCAL lcFile
		lcFile = GETFILE()
		IF !EMPTY(lcFile)
			thisform.oleRawFile.Navigate(lcFile)
			thisform.lblFileName.Caption = "Open File: " + lcFile
			thisform.lblFileName.ToolTipText = lcFile
		
			thisform.lstReport.Clear()
			thisform.txtBegDelimiter.Value = ""
			thisform.txtEndDelimiter.Value = ""
			thisform.edtResult.Value  = ""
			thisform.command4.Enabled = .F.
		ENDIF
	ENDPROC

	PROCEDURE Command2.Click
		LOCAL lnSec, lcText
		IF EMPTY(thisform.txtBegDelimiter.Value)
			MESSAGEBOX("You must enter XML Segment name", 0, "Input Missing")
			RETURN
		ENDIF
		IF EMPTY(thisform.lblFileName.Caption)
			MESSAGEBOX("You must select a file to parse", 0, "Input Missing")
			RETURN
		ENDIF
		thisform.lstReport.Clear()
		lcText = FILETOSTR(thisform.lblFileName.ToolTipText)
		lnSec  = SECONDS()
		thisform.edtResult.Value = thisform.clsFastStrings.GetXMLSegment(lcText, thisform.txtBegDelimiter.Value)
		thisform.lstReport.AddItem("Extract Time: " + TRANSFORM(SECONDS() - lnSec))
	ENDPROC

	PROCEDURE Command3.Click
		LOCAL lnSec, lcText
		IF EMPTY(thisform.txtBegDelimiter.Value)
			MESSAGEBOX("You must enter XML Segment name", 0, "Input Missing")
			RETURN
		ENDIF
		IF EMPTY(thisform.lblFileName.Caption)
			MESSAGEBOX("You must select a file to parse", 0, "Input Missing")
			RETURN
		ENDIF
		IF !ISNULL(thisform.loString)
			thisform.clsFastStrings.ReleaseStringFromHeap(thisform.loString)
			thisform.loString = .NULL.
		ENDIF
		thisform.lstReport.Clear()
		lcText = FILETOSTR(thisform.lblFileName.ToolTipText)
		lnSec    = SECONDS()
		thisform.loString = thisform.clsFastStrings.AddStringToHeap(lcText)
		thisform.edtResult.Value = thisform.clsFastStrings.GetXMLFirstSegment(thisform.loString, thisform.txtBegDelimiter.Value)
		thisform.lstReport.AddItem("First Extract Time: " + TRANSFORM(SECONDS() - lnSec))
		thisform.command4.Enabled = .T.
	ENDPROC

	PROCEDURE Command4.Click
		LOCAL lnSec
		lnSec  = SECONDS()
		thisform.edtResult.Value = thisform.clsFastStrings.GetXMLNextSegment(thisform.loString)
		thisform.lstReport.AddItem("Next Extract Time: " + TRANSFORM(SECONDS() - lnSec))
	ENDPROC

	PROCEDURE Command5.Click
		LOCAL lnSec, lcText, lnCnt, lnBSec
		IF EMPTY(thisform.txtBegDelimiter.Value)
			MESSAGEBOX("You must enter XML Segment name", 0, "Input Missing")
			RETURN
		ENDIF
		IF EMPTY(thisform.lblFileName.Caption)
			MESSAGEBOX("You must select a file to parse", 0, "Input Missing")
			RETURN
		ENDIF
		IF !ISNULL(thisform.loString)
			thisform.clsFastStrings.ReleaseStringFromHeap(thisform.loString)
			thisform.loString = .NULL.
		ENDIF
		thisform.lstReport.Clear()
		lcText = FILETOSTR(thisform.lblFileName.ToolTipText)
		lnSec  = SECONDS()
		thisform.loString = thisform.clsFastStrings.AddStringToHeap(lcText)
		thisform.edtResult.Value = thisform.clsFastStrings.GetXMLFirstSegment(thisform.loString, thisform.txtBegDelimiter.Value)
		thisform.lstReport.AddItem("First Extract Time: " + TRANSFORM(SECONDS() - lnSec))
		LOCAL lnSec, lcText
		IF EMPTY(thisform.txtBegDelimiter.Value)
			MESSAGEBOX("You must enter XML Segment name", 0, "Input Missing")
			RETURN
		ENDIF
		IF EMPTY(thisform.lblFileName.Caption)
			MESSAGEBOX("You must select a file to parse", 0, "Input Missing")
			RETURN
		ENDIF
		IF !ISNULL(thisform.loString)
			thisform.clsFastStrings.ReleaseStringFromHeap(thisform.loString)
			thisform.loString = .NULL.
		ENDIF
		thisform.command4.Enabled = .F.
		thisform.lstReport.Clear()
		lcText = FILETOSTR(thisform.lblFileName.ToolTipText)
		lnSec  = SECONDS()
		lnBSec = lnSec
		thisform.loString = thisform.clsFastStrings.AddStringToHeap(lcText)
		lcText = thisform.clsFastStrings.GetXMLFirstSegment(thisform.loString, thisform.txtBegDelimiter.Value)
		thisform.lstReport.AddItem("First Extract Time: " + TRANSFORM(SECONDS() - lnSec))
		
		lnCnt = 0
		DO WHILE !EMPTY(lcText)
			lnCnt  = lnCnt + 1 
			lnSec  = SECONDS()
			lcText = thisform.clsFastStrings.GetXMLNextSegment(thisform.loString)
			thisform.lstReport.AddItem("Next Extract Time: " + TRANSFORM(SECONDS() - lnSec))
		ENDDO
		thisform.lstReport.AddItem("Total Segments: " + TRANSFORM(lnCnt))
		thisform.lstReport.AddItem("Total Time: " + TRANSFORM(SECONDS() - lnBSec))
	ENDPROC

	PROCEDURE lblFileName.Init
		this.Caption = ""
	ENDPROC

ENDDEFINE
